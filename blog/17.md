---
title: 容器内mysql无法启动解决方案
date: 2023-9-21
---

<font style="color:rgb(69, 69, 69);">容器内无法启动 mysql，导致 console 无法启动。可以通过访问宿主机的 mysql 绕过容器内启动 mysql 的问题。</font>

<font style="color:rgb(69, 69, 69);">操作步骤如下:</font>

<font style="color:rgb(69, 69, 69);">清空 geaflow-console 的容器，关闭宿主机 MySQL 以恢复到初始状态。</font>

<!-- truncate -->

```plain
# 查看容器id
docker ps -a
# 删除容器
docker rm [container-id]
# 查找mysql相关进程号
ps -ef | grep mysql
# 结束MySQL进程
kill [pid]
```

<font style="color:rgb(69, 69, 69);">第一步：启动 geaflow-console 容器</font>

```plain
docker run -d --net=host --name geaflow-console -p 8080:8080 -p 8888:8888 -p 6379:6379 -p 8086:8086 -e geaflow.host=${your.host.name} -e geaflow.web.gateway.url=http://${your.public.ip}:8080 geaflow-console:0.1
```

<font style="color:rgb(69, 69, 69);">注：加上–net=host 参数使得容器和宿主机互通，去掉-p 3306:3306 映射以便访问宿主机 MySQL</font>

<font style="color:rgb(69, 69, 69);">第二步：如有，关闭 geaflow-console 容器内的 MySQL</font>

```plain
# 查看容器id
docker ps -a
# 从宿主机进入容器
docker exec -it [container-id] bash
# 查找mysql相关进程号
ps -ef | grep mysql
# 结束MySQL进程
kill [pid]
```

<font style="color:rgb(69, 69, 69);">第三步：在宿主机启动 MySQL</font>

```plain
# 从容器退出到宿主机
exit
# 如果没有安装mysql，则安装mysql
rpm -Uvh https://dev.mysql.com/get/mysql80-community-release-el7-7.noarch.rpm
rpm --import https://repo.mysql.com/RPM-GPG-KEY-mysql-2022
yum -y install mysql-community-server
mysqld --initialize-insecure --user=mysql
# 启动mysql
nohup mysqld --user=mysql &>> /var/lib/mysql/mysqld.log &
```

<font style="color:rgb(69, 69, 69);">第四步：在宿主机 MySQL 建立 geaflow 数据库，授权</font>

```plain
# 打开mysql shell
mysql
# 建立geaflow数据库
create database geaflow;
# 授权
CREATE USER IF NOT EXISTS geaflow IDENTIFIED BY 'geaflow';
GRANT ALL ON *.* TO 'geaflow'@'%';
FLUSH PRIVILEGES;
```

<font style="color:rgb(69, 69, 69);">第五步：回到 console 容器内，重启 geaflow-console java 进程</font>

```plain
# 查看容器id
docker ps -a
# 从宿主机进入容器
docker exec -it [container-id] bash
# 检查容器内连接宿主机MySQL是否成功
curl http://${your.host.name}:3306
```

<font style="color:rgb(69, 69, 69);">连接宿主机 MySQL 成功如图：</font>![](https://intranetproxy.alipay.com/skylark/lark/0/2025/png/96961/1755590931230-a8c6d558-cae0-4a8d-8fe8-079e4826468a.png)

```plain
# 查找geaflow-console java进程号
ps -ef |grep java
# 结束geaflow-console java进程
kill [pid]
# 重启geaflow-console java进程
java -Xmx4096m -cp /opt/geaflow/boot/geaflow-console-bootstrap.jar:/opt/geaflow/config org.springframework.boot.loader.JarLauncher
```

<font style="color:rgb(69, 69, 69);">结果：访问 console 端口，查看 console 界面是否启动 进入容器等待 geaflow-web 进程启动完成后，访问 ${your.public.ip}:8888 进入 GeaFlow Console 平台页面。</font>

---

<font style="color:rgb(69, 69, 69);">GeaFlow(品牌名 TuGraph-Analytics) 已正式开源，欢迎大家关注！！！</font>

<font style="color:rgb(69, 69, 69);">欢迎给我们 Star 哦!</font>

<font style="color:rgb(69, 69, 69);">Welcome to give us a Star!</font>

<font style="color:rgb(69, 69, 69);">GitHub</font><font style="color:rgb(69, 69, 69);">👉</font>[<font style="color:rgb(255, 81, 0);">https://github.com/TuGraph-family/tugraph-analytics</font>](https://github.com/TuGraph-family/tugraph-analytics)

#### <font style="color:rgb(69, 69, 69);">微信群</font>

![](https://intranetproxy.alipay.com/skylark/lark/0/2025/png/96961/1755590930068-dd98bfe8-1ac0-4c0c-ab21-742389a69b83.png)

<font style="color:rgb(69, 69, 69);">请点击项目链接下方微信二维码添加微信用户群：</font>[<font style="color:rgb(255, 81, 0);">https://github.com/TuGraph-family/tugraph-analytics</font>](https://github.com/TuGraph-family/tugraph-analytics)
