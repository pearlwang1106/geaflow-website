---
title: GeaFlow作业监控面板：运行时组件上的高效分析工具
date: 2023-12-13
---

<font style="color:rgb(69, 69, 69);">作者：丁一</font>

## <font style="color:rgb(69, 69, 69);">背景</font>

<font style="color:rgb(69, 69, 69);">GeaFlow 作业部署到 K8S 集群之后，通常会启动多个 pod（一个 master、一/多个 driver、多个 container）。用户很难判断作业当前运行的进度如何，也不能通过 pod 的状态来判断内部进程的状态。无论是查看进度、查看日志、性能分析，都需要到每一个 pod 中进行对应的操作，运维成本很大，需要一个白屏化的监控页面来监控所有进程的实时状态信息。</font>

<!-- truncate -->

<font style="color:rgb(69, 69, 69);">因此，我们在作业进程中内置了一个 Dashboard（本地启动/容器启动时自动生效），包括前端页面和后端 server，用户可以不需要感知到它们的存在。通过访问 Dashboard，用户可以更方便地通过白屏化的方式查看作业的执行进度、组件列表和详情、任意组件内部的指标、日志等。还可以通过 Profiler 工具对进程状态进行分析，快速定位问题。</font>

## <font style="color:rgb(69, 69, 69);">Dashboard 介绍</font>

<font style="color:rgb(69, 69, 69);">GeaFlow 的 Dashboard 模块提供了作业级别的监控页面，可以轻松地查看作业的以下信息：</font>

- <font style="color:rgb(69, 69, 69);">作业的健康度（Container 和 Worker 活跃度）</font>
- <font style="color:rgb(69, 69, 69);">作业的进度（Pipeline 和 Cycle 信息）</font>
- <font style="color:rgb(69, 69, 69);">作业各个组件的实时日志</font>
- <font style="color:rgb(69, 69, 69);">作业各个组件的进程指标</font>
- <font style="color:rgb(69, 69, 69);">作业各个组件的火焰图</font>
- <font style="color:rgb(69, 69, 69);">作业各个组件的 Thread Dump</font>

## <font style="color:rgb(69, 69, 69);">如何访问页面</font>

<font style="color:rgb(69, 69, 69);">页面的服务部署在 master 组件上，因此直接访问 master 组件的地址即可（默认端口 8090）。</font>

![](https://intranetproxy.alipay.com/skylark/lark/0/2025/png/96961/1755590212959-055d8172-a5f3-4c68-a646-1a4a88c375f3.png)

## <font style="color:rgb(69, 69, 69);">功能介绍</font>

<font style="color:rgb(69, 69, 69);">GeaFlow Dashboard 包含以下几个主要的功能：</font>

### <font style="color:rgb(69, 69, 69);">Overview</font>

<font style="color:rgb(69, 69, 69);">Overview 页面会展示整个作业的健康状态。你可以在这里查看 container 和 driver 是否都在正常运行。</font>

![](https://intranetproxy.alipay.com/skylark/lark/0/2025/png/96961/1755590213043-2b903fe4-0a9d-4bbe-9d00-04856581b9fd.png)

<font style="color:rgb(69, 69, 69);">除此之外，Overview 页面也会展示作业的 Pipeline 列表。</font>

### <font style="color:rgb(69, 69, 69);">作业执行计划进度</font>

<font style="color:rgb(69, 69, 69);">作业的执行计划可以由多个 Pipeline 表示，每个 Pipeline 内部又有多个 Cycle。 可以通过侧边栏的 Pipeline 菜单进入页面。页面包括作业的每一项 Pipeline 的名称、开始时间和耗时。 耗时为 0 表示该 Pipeline 已开始执行，但尚未完成。</font>

![](https://intranetproxy.alipay.com/skylark/lark/0/2025/png/96961/1755590212810-8739ac14-b799-410b-b1ce-ec6506a075be.png)

<font style="color:rgb(69, 69, 69);">点击 Pipeline 名称可以进入二级菜单，查看当前 Pipeline 下所有的 Cycle 列表的各项信息。</font>

![](https://intranetproxy.alipay.com/skylark/lark/0/2025/png/96961/1755590212946-51db16ff-935f-4612-a811-dffee48e1bbc.png)

### <font style="color:rgb(69, 69, 69);">作业组件详情</font>

<font style="color:rgb(69, 69, 69);">可以查看作业的各个组件（包括 master、driver、container）的各项信息。可以通过侧边栏的菜单进行访问。 其中 Driver 详情展示所有 driver 的基础信息。</font>

![](https://intranetproxy.alipay.com/skylark/lark/0/2025/png/96961/1755590213368-3be08b8f-69ac-4a92-a21c-b61224a0b20c.png)

<font style="color:rgb(69, 69, 69);">Container 详情展示所有 Container 的基础信息。</font>

![](https://intranetproxy.alipay.com/skylark/lark/0/2025/png/96961/1755590214303-13a716fc-f5ea-4542-98e5-718cce551183.png)

## <font style="color:rgb(69, 69, 69);">组件运行时详情</font>

<font style="color:rgb(69, 69, 69);">通过点击左边栏的 Master 详情，或者通过点击 Driver/Container 详情中的组件名称，可以跳转到组件的运行时页面。在运行时页面中，可以查看和操作以下内容。</font>

### <font style="color:rgb(69, 69, 69);">进程指标</font>

<font style="color:rgb(69, 69, 69);">展示完整的容器进程指标。</font>

![](https://intranetproxy.alipay.com/skylark/lark/0/2025/png/96961/1755590214470-6744e30f-f556-4242-bed0-816a3e6ad7a5.png)

### <font style="color:rgb(69, 69, 69);">容器日志</font>

<font style="color:rgb(69, 69, 69);">展示容器进程内的主要可见日志。 根据日志的 log4j 配置，默认日志文件大小最大为 128G（此处测试简单起见设置为了 50KB），超过后会进行文件备份。例如 master.log.1 和 master.log.2 就是 master.log 的备份之一。</font>

![](https://intranetproxy.alipay.com/skylark/lark/0/2025/png/96961/1755590214471-77eb802b-3269-44cd-8e00-0a0fc00a5d23.png)

- <font style="color:rgb(69, 69, 69);">master.log：Master 的 java 主进程日志。</font>
- <font style="color:rgb(69, 69, 69);">master.log.1 / master.log.2：Master 的 java 主进程日志备份。</font>
- <font style="color:rgb(69, 69, 69);">agent.log：Master 的 agent 服务日志。</font>
- <font style="color:rgb(69, 69, 69);">geaflow.log：进入容器后的 shell 启动脚本日志。</font>

<font style="color:rgb(69, 69, 69);">点击任意一个日志可以进入日志详情页面。日志的获取进行了后端分页，可以在右下角选择每页的 KB 大小，并可以跳转到指定页数。</font>

![](https://intranetproxy.alipay.com/skylark/lark/0/2025/png/96961/1755590214974-95846ed3-e373-413b-85d4-1371f432a642.png)

### <font style="color:rgb(69, 69, 69);">火焰图</font>

<font style="color:rgb(69, 69, 69);">展示火焰图的历史执行结果，并可重新生成新的火焰图。火焰图分析类型可选择 CPU 或 ALLOC，单次最多分析 60 秒，最多保留 10 份历史记录。 点击“新建”，即可生成新的火焰图。</font>

- <font style="color:rgb(69, 69, 69);">火焰图类型：可选 CPU 或者 ALLOC（Memory）。</font>
- <font style="color:rgb(69, 69, 69);">执行时间：分析时间，需介于 1~60 秒之间。</font>

![](https://intranetproxy.alipay.com/skylark/lark/0/2025/png/96961/1755590215395-c4ce2c5e-88a5-4dd3-82bc-8d6412029ee8.png)

<font style="color:rgb(69, 69, 69);">火焰图的执行时间根据用户的选择可能较久，因此会在后台静默执行。需要等待执行结束后，手动点击“新建”按钮旁边的“刷新”标识，获取最新的火焰图历史。</font>

![](https://intranetproxy.alipay.com/skylark/lark/0/2025/png/96961/1755590215967-a21f6481-5c7c-4d89-a508-8e4d38c679fe.png)

![](https://intranetproxy.alipay.com/skylark/lark/0/2025/png/96961/1755590216098-1f0c4ace-4220-4b75-8a00-67b115928348.png)

### <font style="color:rgb(69, 69, 69);">Thread Dump</font>

<font style="color:rgb(69, 69, 69);">展示主进程的 Thread Dump 结果，并可重新进行 Dump。保留最新一次 dump 的结果。</font>

![](https://intranetproxy.alipay.com/skylark/lark/0/2025/png/96961/1755590215996-b4c56320-41bc-4d9d-b397-cdd508981504.png)

<font style="color:rgb(69, 69, 69);">点击“重新执行”，等待执行结束后，结果会自动刷新。</font>![](https://intranetproxy.alipay.com/skylark/lark/0/2025/png/96961/1755590216542-9f487cf0-46ba-4fb4-85e5-3570c403f78c.png)

### <font style="color:rgb(69, 69, 69);">进程配置</font>

<font style="color:rgb(69, 69, 69);">展示 master 的 java 主进程内的各项配置（仅 master 拥有此页面）。</font>

![](https://intranetproxy.alipay.com/skylark/lark/0/2025/png/96961/1755590217049-a40d0ad9-d2ba-4847-b48d-753cfa7ed2b3.png)

## <font style="color:rgb(69, 69, 69);">其他用法</font>

### <font style="color:rgb(69, 69, 69);">列表排序与查询</font>

<font style="color:rgb(69, 69, 69);">部分列表的列可以进行排序和查询。 查询时，点击“搜索”标识，输入关键字，点击“搜索”按钮即可。 重置时，点击“重置”按钮，列表会重新刷新。</font>

![](https://intranetproxy.alipay.com/skylark/lark/0/2025/png/96961/1755590217797-1a4c6134-6404-4d30-96eb-be6a602f255e.png)

### <font style="color:rgb(69, 69, 69);">国际化</font>

<font style="color:rgb(69, 69, 69);">页面支持中英文切换，点击右上角的“文 A”图标，即可选择语言。</font>

![](https://intranetproxy.alipay.com/skylark/lark/0/2025/png/96961/1755590218271-66ff908d-375c-4b46-ad5d-4c4af20591ca.png)

**<font style="color:rgb(69, 69, 69);">欢迎关注我们的 GitHub 仓库：</font>**<font style="color:rgb(69, 69, 69);"> </font>[<font style="color:rgb(255, 81, 0);">https://github.com/TuGraph-family/tugraph-analytics</font>](https://github.com/TuGraph-family/tugraph-analytics)

---

<font style="color:rgb(69, 69, 69);">GeaFlow(品牌名 TuGraph-Analytics) 已正式开源，欢迎大家关注！！！</font>

<font style="color:rgb(69, 69, 69);">欢迎给我们 Star 哦!</font>

<font style="color:rgb(69, 69, 69);">Welcome to give us a Star!</font>

<font style="color:rgb(69, 69, 69);">GitHub</font><font style="color:rgb(69, 69, 69);">👉</font>[<font style="color:rgb(255, 81, 0);">https://github.com/TuGraph-family/tugraph-analytics</font>](https://github.com/TuGraph-family/tugraph-analytics)

## <font style="color:rgb(69, 69, 69);">微信群</font>

![](https://intranetproxy.alipay.com/skylark/lark/0/2025/png/96961/1755590218601-186a3032-f408-4645-925a-53a0307beb8f.png)

<font style="color:rgb(69, 69, 69);">请点击项目链接下方微信二维码添加微信用户群：</font>[<font style="color:rgb(255, 81, 0);">https://github.com/TuGraph-family/tugraph-analytics</font>](https://github.com/TuGraph-family/tugraph-analytics)
